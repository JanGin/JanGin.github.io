<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5"><title>密码学原理 | JanGin's BLOG</title><meta name="description" content="密码学原理"><meta name="keywords" content="密码学"><meta name="author" content="JanGin"><meta name="copyright" content="JanGin"><meta name="format-detection" content="telephone=no"><link rel="shortcut icon" href="/img/favicon.ico"><link rel="preconnect" href="//cdn.jsdelivr.net"><link rel="preconnect" href="https://fonts.googleapis.com" crossorigin><meta name="twitter:card" content="summary"><meta name="twitter:title" content="密码学原理"><meta name="twitter:description" content="密码学原理"><meta name="twitter:image" content="http://jangin.github.io/img/5631855_p0.jpg"><meta property="og:type" content="article"><meta property="og:title" content="密码学原理"><meta property="og:url" content="http://jangin.github.io/2021/08/01/cryptography-principle/"><meta property="og:site_name" content="JanGin's BLOG"><meta property="og:description" content="密码学原理"><meta property="og:image" content="http://jangin.github.io/img/5631855_p0.jpg"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><script src="https://cdn.jsdelivr.net/npm/js-cookie/dist/js.cookie.min.js"></script><script>const autoChangeMode = 'true'
var t = Cookies.get("theme");
if (autoChangeMode == '1'){
const isDarkMode = window.matchMedia("(prefers-color-scheme: dark)").matches
const isLightMode = window.matchMedia("(prefers-color-scheme: light)").matches
const isNotSpecified = window.matchMedia("(prefers-color-scheme: no-preference)").matches
const hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified

if (t === undefined){
  if (isLightMode) activateLightMode()
  else if (isDarkMode) activateDarkMode()
  else if (isNotSpecified || hasNoSupport){
    console.log('You specified no preference for a color scheme or your browser does not support it. I Schedule dark mode during night time.')
    now = new Date();
    hour = now.getHours();
    isNight = hour < 6 || hour >= 18
    isNight ? activateDarkMode() : activateLightMode()
}
} else if (t == 'light') activateLightMode()
else activateDarkMode()


} else if (autoChangeMode == '2'){
  now = new Date();
  hour = now.getHours();
  isNight = hour < 6 || hour >= 18
  if(t === undefined) isNight? activateDarkMode() : activateLightMode()
  else if (t === 'light') activateLightMode()
  else activateDarkMode() 
} else {
  if ( t == 'dark' ) activateDarkMode()
  else if ( t == 'light') activateLightMode()
}

function activateDarkMode(){
  document.documentElement.setAttribute('data-theme', 'dark')
  if (document.querySelector('meta[name="theme-color"]') !== null){
    document.querySelector('meta[name="theme-color"]').setAttribute('content','#000')
  }
}
function activateLightMode(){
  document.documentElement.setAttribute('data-theme', 'light')
  if (document.querySelector('meta[name="theme-color"]') !== null){
  document.querySelector('meta[name="theme-color"]').setAttribute('content','#fff')
  }
}</script><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@latest/css/font-awesome.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css"><link rel="canonical" href="http://jangin.github.io/2021/08/01/cryptography-principle/"><link rel="prev" title="JUC系列(1) —— ThreadPool 线程池" href="http://jangin.github.io/2021/08/15/juc-jdk-threadpool/"><link rel="next" title="哲学家就餐问题" href="http://jangin.github.io/2021/07/30/dining-philosophers-problem/"><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/gitalk/dist/gitalk.min.css"><script src="https://cdn.jsdelivr.net/npm/gitalk@latest/dist/gitalk.min.js"></script><script src="https://cdn.jsdelivr.net/npm/blueimp-md5@2.10.0/js/md5.min.js"></script><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Titillium+Web"><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  bookmark: {
    title: 'Snackbar.bookmark.title',
    message_prev: '按',
    message_next: '键将本页加入书签'
  },
  runtime_unit: '天',
  runtime: true,
  copyright: {"languages":{"author":"作者: JanGin","link":"链接: http://jangin.github.io/2021/08/01/cryptography-principle/","source":"来源: JanGin's BLOG","info":"著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。"}},
  ClickShowText: undefined,
  medium_zoom: false,
  fancybox: true,
  Snackbar: undefined,
  baiduPush: false,
  isHome: false,
  isPost: true
  
}</script><meta name="generator" content="Hexo 4.2.0"></head><body><header> <div id="page-header"><span class="pull_left" id="blog_name"><a class="blog_title" id="site-name" href="/">JanGin's BLOG</a></span><span class="toggle-menu pull_right close"><a class="site-page"><i class="fa fa-bars fa-fw" aria-hidden="true"></i></a></span><span class="pull_right menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fa fa-folder-open"></i><span> 分类</span></a></div></div></span></div></header><div id="mobile-sidebar"><div id="menu_mask"></div><div id="mobile-sidebar-menus"><div class="mobile_author_icon"><img class="avatar-img" src="/img/avatar.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"></div><div class="mobile_post_data"><div class="mobile_data_item is-center"><div class="mobile_data_link"><a href="/archives/"><div class="headline">文章</div><div class="length_num">41</div></a></div></div><div class="mobile_data_item is-center">      <div class="mobile_data_link"><a href="/tags/"><div class="headline">标签</div><div class="length_num">43</div></a></div></div><div class="mobile_data_item is-center">     <div class="mobile_data_link"><a href="/categories/"><div class="headline">分类</div><div class="length_num">15</div></a></div></div></div><hr><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fa fa-folder-open"></i><span> 分类</span></a></div></div></div><div id="mobile-sidebar-toc"><div class="toc_mobile_headline">目录</div><div class="sidebar-toc__content"><ol class="toc_mobile_items"><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#一-密码学的历史"><span class="toc_mobile_items-text">一. 密码学的历史</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#二-信息论时代的密码学"><span class="toc_mobile_items-text">二. 信息论时代的密码学</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#三-Java-代码实现"><span class="toc_mobile_items-text">三. Java 代码实现</span></a></li></ol></div></div></div><div id="body-wrap"><i class="fa fa-arrow-right" id="toggle-sidebar" aria-hidden="true">     </i><div class="auto_open" id="sidebar"><div class="sidebar-toc"><div class="sidebar-toc__title">目录</div><div class="sidebar-toc__progress"><span class="progress-notice">你已经读了</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar">     </div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-4"><a class="toc-link" href="#一-密码学的历史"><span class="toc-text">一. 密码学的历史</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#二-信息论时代的密码学"><span class="toc-text">二. 信息论时代的密码学</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#三-Java-代码实现"><span class="toc-text">三. Java 代码实现</span></a></li></ol></div></div></div><main id="content-outer"><div id="top-container" style="background-image: url(/img/5631855_p0.jpg)"><div id="post-info"><div id="post-title"><div class="posttitle">密码学原理</div></div><div id="post-meta"><time class="post-meta__date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 2021-08-01</time><span class="post-meta__separator">|</span><span><i class="fa fa-inbox post-meta__icon fa-fw" aria-hidden="true"></i><a class="post-meta__categories" href="/categories/%E6%97%A5%E5%B8%B8%E6%80%BB%E7%BB%93/">日常总结</a></span><div class="post-meta-wordcount"><i class="fa fa-file-word-o post-meta__icon fa-fw" aria-hidden="true"></i><span>字数总计:</span><span class="word-count">1.9k</span><span class="post-meta__separator">|</span><i class="fa fa-clock-o post-meta__icon fa-fw" aria-hidden="true"></i><span>阅读时长: 6 分钟</span><div class="post-meta-pv-cv"></div></div></div></div></div><div class="layout layout_post" id="content-inner">   <article id="post"><div class="article-container" id="post-content"><blockquote>
<p>密码学是现代计算机安全通信的基石，早已在日常生活中被广泛应用。现代密码学的基层支撑是数学，而且还和信息论密切相关。恰巧最近看的吴军博士的《数学之美》中第17章也提到了密码学，因此鄙人打算将此篇当作一个读书笔记来写。</p>
</blockquote>
<h4 id="一-密码学的历史"><a href="#一-密码学的历史" class="headerlink" title="一. 密码学的历史"></a>一. 密码学的历史</h4><p>关于密码学的历史，最早大致可以追溯到古罗马时期。古罗马皇帝凯撒 (<em>Julius Caesar</em>) 为了防止敌方截获情报，采用密码传送情报。其做法很简单，就是给二十来个罗马字母建立一张对应表，大致如下：</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div></div><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">明码        密码</span><br><span class="line">-----------------</span><br><span class="line"> A           B</span><br><span class="line"> B           E</span><br><span class="line"> C           A</span><br><span class="line"> D           F</span><br><span class="line"> ...         ...</span><br><span class="line"> R           P</span><br><span class="line"> S           T</span><br><span class="line"> ...         ...</span><br></pre></td></tr></table></figure></div>

<p>这样一一对应之后，如果不知道密码本，即使截获一段信息，由于是加过密之后的乱码，敌人也会不得其解，可以说是实现了加密的目的。（如看上去毫无意义的 ABKTBP 经过解密后可得其实就是 CAESAR 一词）这种密码本一一对应的编码方法，史称 “凯撒大帝”。但是这种加密方式的安全与否，一方面取决于密码本保存的是否安全。另一方面，即使在不知道密码本的情况下，通过统计单词字母的出现频率（如高频词在经过密码本加密之后所对应的形式，出现的次数也一定是高频的）也可以推断出明文。因此，密码的设计者们开始逐渐地意识到，对于一种好的编码方式，破译者应该无法从密码中统计出明码的规律。更进一步的讲，什么才算是好的密码？好的密码要求必须做到根据已知的明文和密文的对应无法推断出新的密文内容。从数学的角度看，加解密的过程类似于这样：</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div></div><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">graph LR</span><br><span class="line"></span><br><span class="line">明码 --&gt; | 加密| 密码</span><br><span class="line">密码 --&gt; | 解密| 明码</span><br></pre></td></tr></table></figure></div>

<p>加密的过程可以看作是一个函数运算 <strong><em>F</em></strong>, 解密的过程是含函数的运算。明码是自变量，密码就是函数的输出结果，也就是函数值。 好的函数不应该通过几个自变量和函数值就能推出函数本身。这一点在二战及其之前做得很不好。比如美国就多次在二战中破译了日本军方的密码电报，并成功地在中途岛海战中伏击了日本联合舰队。</p>
<h4 id="二-信息论时代的密码学"><a href="#二-信息论时代的密码学" class="headerlink" title="二. 信息论时代的密码学"></a>二. 信息论时代的密码学</h4><p>二战期间，很多当时的顶级科学家如香农 (<em>Sharon</em>)、图灵 (<em>Turing</em>) 都参与到了军方的情报加解密工作当中。香农负责研究如何为英国首相 丘吉尔和美国的通话加密，而图灵则主要研究如何解密德国人的密码机。在这个研究过程当中，香农提出了信息论，而信息论可以说是现代通信的理论基石了。信息论的提出给密码学的发展前进带来了新气象。根据信息论，密码的最高境界是敌方在截获密码之后，对我方的所知没有任何增加，用专业术语来说，就是其对我方所拥有的信息量没有增加。因为信息论的出现，现代密码的设计就有了理论基础。现如今通用的公开密钥的方法（即非对称加密，公钥和私钥是不同且配对出现，公钥公开，私钥不公开，用公钥加密的密文只有用私钥才能解开。与之相应的还有对称加密，对称加密采用相同的公钥和私钥）及其电子签名是今天大多数互联网安全协议的基础。</p>
<p>公开公钥的加密方法有很多，下面就用相对简单的 <strong>RSA</strong> 算法来描述非对称加密的原理。</p>
<p>假设此刻的明文为 <strong><em>X</em></strong> = 067097101115097114 （‘<em>Caesar</em> ’  对应的 ASCII码串）</p>
<p>非对称加密的基本步骤：</p>
<ol>
<li>找两大很大的素数（很大的意思是最好有上百位）<code>P</code> 和 <code>Q</code> , 计算它们的乘积得：<code>N = P * Q</code></li>
<li>再计算 <code>M = (P-1)(Q-1)</code> 得到 <em>M</em></li>
<li>找一个和  <strong><em>M</em></strong> 互素的整数 <strong><em>E</em></strong>， 再找一个整数 <strong><em>D</em></strong>，使得 <strong><em>E</em></strong> * <strong><em>D</em></strong> mod <strong><em>M</em></strong> = 1</li>
</ol>
<p>经过上述几步，就有了一个先进且最常用的密码系统了。其中呢， <strong><em>E</em></strong> 是公钥，是对外公开的，谁都可以保存。 <strong><em>D</em></strong> 是用于解密私钥，只能有解密方好好保存。 联系公钥和私钥的乘积 <strong><em>N</em></strong> 也是公开的，就算被人知道了也没关系。</p>
<p>采用下面的公式<br>$$<br>X^E mod {N} = Y<br>$$<br>对 <strong><em>X</em></strong> 加密，得到密文 <strong><em>Y</em></strong>. 现在没有了私钥 <strong><em>D</em></strong>，神仙也没有办法从 <strong><em>Y</em></strong> 中得到 <strong><em>X</em></strong>.  如果知道了私钥 <strong><em>D</em></strong>，则根据 <a href="https://baike.baidu.com/item/%E8%B4%B9%E9%A9%AC%E5%B0%8F%E5%AE%9A%E7%90%86" target="_blank" rel="noopener">费马小定理</a> 按照下列公式<br>$$<br> Y^D mod {N} = X<br>$$<br>就可以从 <strong><em>Y</em></strong> 中得到原来的 <strong><em>X</em></strong>.</p>
<p>通过一些简单的乘除运算，就可以得到目前来看最为可靠的安全加密方式，这不正好是将 “数学之美” 体现得淋漓尽致吗？</p>
<p>那么这样的密文破解起来有多难呢？首先说明世界上没有破解不了的密码，关键是看这个破解要花费多长时间，也就是密码的有效期。如果一个密码经历一百年都破解不出来，那我们完全可以说这个密码对于个人而言是绝对安全的，毕竟真没有几个人能活这么长时间。密码的有效期靠什么来保证呢？ 靠的是大数的因式分解的困难程度。至今的研究结果表明，要破解这样的加密最彻底的办法还是对 大数 <strong><em>N</em></strong> 进行因式分解来求得 <strong><em>P</em></strong> 和 <strong><em>Q</em></strong>. 只要把这俩找到了，这密码就算成功破解了。而找 <strong><em>P</em></strong> 和 <strong><em>Q</em></strong> 目前所能采用的依然只有穷举法这一种。这实际上考验的就是计算机的计算能力，这也是为什么在选择  <strong><em>P</em></strong> 和 <strong><em>Q</em></strong>  时要求这俩数的长度要特别长的原因所在。对于 <strong>RSA</strong> 来说，就目前的情况来看，512位的密钥被视为不安全的，768位的密钥不用担心受到除了国家安全管理（NSA）外的其他事物的危害，1024位的密钥则几乎是安全的。</p>
<h4 id="三-Java-代码实现"><a href="#三-Java-代码实现" class="headerlink" title="三. Java 代码实现"></a>三. Java 代码实现</h4><p>日常开发中常用的 RSA 加密方式 Java 代码</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">java</div></div><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">RSATest</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> KeyPair keyPair;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            keyPair = generateKeyPair();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (NoSuchAlgorithmException e) &#123;</span><br><span class="line">            System.err.println(e.getMessage());</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> GeneralSecurityException </span>&#123;</span><br><span class="line"></span><br><span class="line">        String plainText = <span class="string">"helloWorld"</span>;</span><br><span class="line">        String encrypted = rsaEncrypt(plainText);</span><br><span class="line">        System.out.println(encrypted);</span><br><span class="line">        String decrypted = rsaDecrypt(encrypted);</span><br><span class="line">        System.out.println(decrypted);</span><br><span class="line">        System.out.println(plainText.equals(decrypted));	<span class="comment">// it will output "true"</span></span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title">rsaEncrypt</span><span class="params">(String plainText)</span> <span class="keyword">throws</span> GeneralSecurityException </span>&#123;</span><br><span class="line">        PublicKey publicKey = keyPair.getPublic();</span><br><span class="line">        X509EncodedKeySpec x509EncodedKeySpec = <span class="keyword">new</span> X509EncodedKeySpec(publicKey.getEncoded());</span><br><span class="line">        KeyFactory keyFactory = KeyFactory.getInstance(<span class="string">"RSA"</span>);</span><br><span class="line">        Key pubkey = keyFactory.generatePublic(x509EncodedKeySpec);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 公钥加密数据</span></span><br><span class="line">        Cipher cipher = Cipher.getInstance(keyFactory.getAlgorithm());</span><br><span class="line">        cipher.init(Cipher.ENCRYPT_MODE, pubkey);</span><br><span class="line">        <span class="keyword">byte</span>[] encryptData = cipher.doFinal(plainText.getBytes(StandardCharsets.UTF_8));</span><br><span class="line">        <span class="keyword">return</span> getBas64Encoder().encodeToString(encryptData);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title">rsaDecrypt</span><span class="params">(String encryptText)</span> <span class="keyword">throws</span> GeneralSecurityException </span>&#123;</span><br><span class="line">        PrivateKey privateKey = keyPair.getPrivate();</span><br><span class="line">        PKCS8EncodedKeySpec pkcs8EncodedKeySpec = <span class="keyword">new</span> PKCS8EncodedKeySpec(privateKey.getEncoded());</span><br><span class="line">        <span class="keyword">byte</span>[] encrypted = getBas64Decoder().decode(encryptText.getBytes(StandardCharsets.UTF_8));</span><br><span class="line">        KeyFactory keyFactory = KeyFactory.getInstance(<span class="string">"RSA"</span>);</span><br><span class="line">        Key prikey = keyFactory.generatePrivate(pkcs8EncodedKeySpec);</span><br><span class="line">        Cipher cipher = Cipher.getInstance(keyFactory.getAlgorithm());</span><br><span class="line">        cipher.init(Cipher.DECRYPT_MODE, prikey);</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> String(cipher.doFinal(encrypted));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> KeyPair <span class="title">generateKeyPair</span><span class="params">()</span> <span class="keyword">throws</span> NoSuchAlgorithmException </span>&#123;</span><br><span class="line">        KeyPairGenerator keyPairGenerator = KeyPairGenerator.getInstance(<span class="string">"RSA"</span>);</span><br><span class="line">        keyPairGenerator.initialize(<span class="number">1024</span>);</span><br><span class="line">        KeyPair keyPair = keyPairGenerator.generateKeyPair();</span><br><span class="line">        <span class="keyword">return</span> keyPair;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span>  Base64.<span class="function">Decoder <span class="title">getBas64Decoder</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> Base64.getDecoder();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span>  Base64.<span class="function">Encoder <span class="title">getBas64Encoder</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> Base64.getEncoder();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>
</div></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:undefined">JanGin</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="http://jangin.github.io/2021/08/01/cryptography-principle/">http://jangin.github.io/2021/08/01/cryptography-principle/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank" rel="noopener">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="http://jangin.github.io">JanGin's BLOG</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/%E5%AF%86%E7%A0%81%E5%AD%A6/">密码学    </a></div><div class="post_share"><div class="social-share" data-image="/img/5631855_p0.jpg" data-sites="wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css"><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js"></script></div></div><nav class="pagination_post" id="pagination"><div class="prev-post pull_left"><a href="/2021/08/15/juc-jdk-threadpool/"><img class="prev_cover lazyload" data-src="/img/5631855_p0.jpg" onerror="onerror=null;src='/img/404.jpg'"><div class="label">上一篇</div><div class="prev_info"><span>JUC系列(1) —— ThreadPool 线程池</span></div></a></div><div class="next-post pull_right"><a href="/2021/07/30/dining-philosophers-problem/"><img class="next_cover lazyload" data-src="/2021/07/30/dining-philosophers-problem/An_illustration_of_the_dining_philosophers_problem.png" onerror="onerror=null;src='/img/404.jpg'"><div class="label">下一篇</div><div class="next_info"><span>哲学家就餐问题</span></div></a></div></nav><hr><div id="post-comment"><div class="comment_headling"><i class="fa fa-comments fa-fw" aria-hidden="true"></i><span> 评论</span></div><div id="gitalk-container"></div><script>var createIssueManually = false == true ? true : false;
var distractionFreeMode = false == true ? true : false;
var gitalk = new Gitalk({
  clientID: '8f7ff08a551decb36889',
  clientSecret: '0d940a105b3cb872a385d069355a86f7c6a947c7',
  repo: 'gittalk',
  owner: 'jangin',
  admin: 'jangin',
  id: md5(decodeURI(location.pathname)),
  createIssueManually: createIssueManually,
  distractionFreeMode: distractionFreeMode,
  language: 'en , zh-CN ,',
  updateCountCallback: commentCount
})
gitalk.render('gitalk-container')

function commentCount(n){
  document.getElementsByClassName('gitalk-comment-count')[0].innerHTML= n
}</script></div></div></main><footer id="footer" data-type="color"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2021 By JanGin</div><div class="framework-info"><span>驱动 </span><a href="http://hexo.io" target="_blank" rel="noopener"><span>Hexo</span></a><span class="footer-separator">|</span><span>主题 </span><a href="https://github.com/jerryc127/hexo-theme-butterfly" target="_blank" rel="noopener"><span>Butterfly</span></a></div></div></footer></div><section class="rightside" id="rightside"><div id="rightside-config-hide"><i class="fa fa-book" id="readmode" title="阅读模式"></i><i class="fa fa-plus" id="font_plus" title="放大字体"></i><i class="fa fa-minus" id="font_minus" title="缩小字体"></i><i class="darkmode fa fa-moon-o" id="darkmode" title="夜间模式"></i></div><div id="rightside-config-show"><div id="rightside_config" title="设置"><i class="fa fa-cog" aria-hidden="true"></i></div><a id="to_comment" href="#post-comment" title="直达评论"><i class="scroll_to_comment fa fa-comments">  </i></a><i class="fa fa-list-ul close" id="mobile-toc-button" title="目录" aria-hidden="true"></i><i class="fa fa-arrow-up" id="go-up" title="回到顶部" aria-hidden="true"></i></div></section><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page@latest/instantpage.min.js" type="module"></script><script src="https://cdn.jsdelivr.net/npm/lazysizes@latest/lazysizes.min.js" async=""></script><script src="https://cdn.jsdelivr.net/gh/jerryc127/butterfly_cdn@2.1.0/js/click_heart.js"></script></body></html>